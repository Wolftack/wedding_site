<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>RSVP â€¢ Luba & Tackin</title>
  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="assets/rsvp.css">
</head>
<body class="rsvp-theme">
  <div class="topbar">
    <div class="navwrap">
      <a class="logo" href="index.html">Luba & Tackin</a>
      <nav class="nav">
        <a href="index.html">Schedule</a>
        <a href="travel.html">Travel</a>
        <a href="faqs.html">FAQs</a>
        <a href="rsvp.html">RSVP</a>
        <a href="registry.html">Registry</a>
      </nav>
    </div>
  </div>

  <div class="rsvp-wrap">
    <section class="rsvp-card">
      <h1>RSVP</h1>
      <p>Enter your email address to access your RSVP form.</p>

      <div id="rsvpStep1" style="max-width:520px;">
        <input
          id="rsvpEmail"
          type="email"
          placeholder="sharks@gelato.org"
          style="width:100%;padding:12px;font-size:16px;box-sizing:border-box;"
          autocomplete="email"
          required
        />
        <button
          id="rsvpGo"
          style="margin-top:12px;width:100%;padding:12px;font-size:16px;cursor:pointer;"
          type="button"
        >
          Continue
        </button>

        <div id="rsvpErr" style="display:none;margin-top:10px;color:#b00020;"></div>
      </div>

      <div id="rsvpStep2" style="display:none; width:100%; margin-top:18px;">
        <iframe
          id="rsvpFrame"
          style="width:100%; max-width:1200px; height:1600px; border:0; display:block;"
          scrolling="yes"
          allow="clipboard-read; clipboard-write"
        ></iframe>
      </div>
    </section>
  </div>

  <script>
    // highlight active tab
    (function () {
      const here = location.pathname.split('/').pop() || 'index.html';
      document.querySelectorAll('.nav a').forEach(a => {
        if (a.getAttribute('href') === here) a.classList.add('active');
      });
    })();

    // RSVP embed logic (runs after DOM is ready)
    window.addEventListener('DOMContentLoaded', () => {
      const APP_URL = "https://script.google.com/macros/s/AKfycbwUXorUhYNOOSQw32ZLCVbB4EX5-O0hK94Pq1HrqfcUjgAc8caE3LfvNBwpyoG5KY8-/exec";

      const emailEl = document.getElementById('rsvpEmail');
      const goBtn = document.getElementById('rsvpGo');
      const errEl = document.getElementById('rsvpErr');
      const step1 = document.getElementById('rsvpStep1');
      const step2 = document.getElementById('rsvpStep2');
      const frame = document.getElementById('rsvpFrame');

      function go() {
        const email = (emailEl.value || '').trim();

        if (!email) {
          errEl.style.display = 'block';
          errEl.textContent = 'Please enter your email address.';
          return;
        }

        errEl.style.display = 'none';

        const iframeUrl = APP_URL + "?page=rsvp&email=" + encodeURIComponent(email);
        frame.src = iframeUrl;

        step1.style.display = 'none';
        step2.style.display = 'block';

        step2.scrollIntoView({ behavior: 'smooth' });
      }

      goBtn.addEventListener('click', go);
      emailEl.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') go();
      });
    });
  </script>
</body>
</html>
